
--Carga dimensao funcionario--

DELETE
FROM [dw].[dimensao_funcionario]

INSERT INTO [dw].[dimensao_funcionario]
(
	[id_funcionario],
	[ultimo_nome],
	[primeiro_nome],
	[titulo],
	[data_nascimento],
	[data_contracao],
	[endereco],
	[cidade],
	[regiao],
	[codigo_postal],
	[pais],
	[telefone]
)
SELECT
    id_funcionario
    ,ultimo_nome
    ,primeiro_nome
    ,titulo
    ,data_nascimento
    ,data_contracao
    ,endereco
    ,cidade
    ,regiao
    ,codigo_postal
    ,pais
    ,telefone
FROM stage.employees

select count (*) as funcionario
from [dw].[dimensao_funcionario]

--carga dimensao cliente 


DELETE
FROM dw.dimensao_cliente

INSERT INTO dw.dimensao_cliente
	(
    [id_cliente],
	[nome_companhia],
	[nome_contato], 
	[titulo_contato],
	[endereco],
	[cidade], 
	[regiao], 
	[codigo_postal],
	[pais],
	[telefone])

SELECT 
      id_cliente
     , nome_empresa
      , nome_contato
      ,_titulo_contato
      , endereco 
      ,cidade
      ,regiao
      ,codigo_postal
      ,pais
      ,telefone
  FROM stage.customers

select count(*) as cliente
from dw.dimensao_cliente


--carga dimensao local--

DELETE 
FROM [dw].[dimensao_local];

INSERT INTO [dw].[dimensao_local]
( 
    [id_cliente],
    [id_pedido]
    [endereco_envio],
	[cidade_envio], 
	[regiao_envio], 
	[codpostal_envio], 
	[pais_envio]
)
SELECT
    id_cliente,
    id_pedido
    endereco, 
    cidade,
    estado,
    codigo_postal,
    pais
 FROM stage.local

select count(*) as [local]
from [dw].[dimensao_local]

--carga dimensao de produto--

DELETE 
FROM [dw].[dimensao_produto];

INSERT INTO [dw].[dimensao_produto]
(
    id_produto
    ,id_categoria
    ,nome_categoria
    ,sub_categoria
    ,nome_produto
    ,id_fornecedor
    ,fornecedor
    ,preco_unitario
)

SELECT 
     od.id_produto
     c.id_categoria
     ,categoria
     ,sub_categoria
     ,nome_produto
     ,s.supplierid
     ,fornecedor,
     p.preco_unitario
    FROM stage.categories AS c
    JOIN stage.Products as p 
        ON c.id_categoria = p.id_categoria
    JOIN stage.suppliers as s
        ON p.supplierid = s.supplierid
   JOIN stage.orderdetails as od ON od.preco_unitario =  p.preco_unitario


